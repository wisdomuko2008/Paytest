<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flexi CBT – Payment</title>

<style>
/* Hide content initially */
body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f4f6f4;
  visibility: hidden; /* HIDDEN until Paystack loads */
}

.container {
  background: #fff;
  padding: 30px;
  width: 100%;
  max-width: 420px;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,.15);
}

h2 { text-align: center; color: #0b6623; }
p { text-align: center; }
input {
  width: 100%;
  padding: 12px;
  margin: 12px 0;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 16px;
}
button {
  width: 100%;
  padding: 12px;
  background: #0b6623;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
}
button:hover { opacity: 0.9; }

.status { text-align: center; font-weight: bold; margin-top: 15px; }

/* Optional preloader style */
#preloader {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f4f6f4;
  z-index: 9999;
  font-size: 18px;
  color: #0b6623;
}
</style>
</head>
<body>

<div id="preloader">Loading payment system, please wait...</div>

<div class="container">
  <h2>CBT Access Payment</h2>
  <p>Pay <b>₦500</b> to unlock the CBT exam</p>

  <input type="tel" id="whatsapp" placeholder="WhatsApp Number e.g. 0803xxxxxxx">
  <button id="payBtn">Pay ₦500</button>

  <div class="status" id="status"></div>
</div>

<script>
// 1️⃣ Hide page until Paystack loads
const body = document.body;
const preloader = document.getElementById("preloader");
const payBtn = document.getElementById("payBtn");
const status = document.getElementById("status");
const whatsappInput = document.getElementById("whatsapp");

// Disable button initially
payBtn.disabled = true;

// 2️⃣ Load Paystack script dynamically
const paystackScript = document.createElement("script");
paystackScript.src = "https://js.paystack.co/v1/inline.js";
paystackScript.onload = () => {
    preloader.style.display = "none";  // hide preloader
    body.style.visibility = "visible"; // show page
    payBtn.disabled = false;           // enable button
};
document.head.appendChild(paystackScript);

// 3️⃣ Pay function
function pay() {
    const whatsapp = whatsappInput.value.trim();
    if (!whatsapp) {
        status.textContent = "❌ Enter your WhatsApp number";
        return;
    }

    status.textContent = "Opening payment gateway...";

    const handler = PaystackPop.setup({
        key: "pk_live_bb0c7b83bfdbd0c9990e2c7f7fd73a86d4821a00", // replace with your key
        email: whatsapp + "@flexicbt.com",
        amount: 500 * 100,
        currency: "NGN",
        callback: function(response) {
            status.textContent = "✅ Payment successful! Reference: " + response.reference;
        },
        onClose: function() {
            status.textContent = "❌ Payment cancelled";
        }
    });

    handler.openIframe();
}

payBtn.addEventListener("click", pay);
</script>

</body>
</html>
